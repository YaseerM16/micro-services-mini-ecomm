# my-project/backend/Dockerfile
# Base image
FROM node:18-alpine

# Set working directory
WORKDIR /app

# Copy package.json and package-lock.json for each service if dependencies differ
COPY user-service/package*.json ./user-service/
COPY product-service/package*.json ./product-service/
COPY order-service/package*.json ./order-service/
COPY api-gateway/package*.json ./api-gateway/

# Install dependencies for each service
RUN cd user-service && npm install
RUN cd ../product-service && npm install
RUN cd ../order-service && npm install
RUN cd ../api-gateway && npm install

# Copy the rest of the backend code
COPY . .

# Run each service in the background or with a process manager (e.g., pm2)
CMD ["npm", "run", "start-all-services"] # Assuming you have a script to start all services

# Expose the required ports
EXPOSE 3000 4000 5000 